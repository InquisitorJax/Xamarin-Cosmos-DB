<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="XamarinCosmosDB.MainPage"
             xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:Wibci.Xamarin.Forms.Converters;assembly=Wibci.Xamarin.Forms.Converters"
             xmlns:d="http://xamarin.com/schemas/2014/forms/design"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">


	<Grid Margin="12" RowDefinitions="Auto, *">
		<StackLayout Spacing="12">
			<StackLayout.Resources>
				<converters:BooleanToInvertedBooleanConverter x:Key="bib" />
				<converters:NullValueToBooleanConverter x:Key="nvc" />
			</StackLayout.Resources>

			<StackLayout Orientation="Horizontal">
				<Switch IsToggled="{Binding UseLocalResourceTokenBroker}" />
				<Label Text="Use Local Cosmos DB Resource Token Broker Function" />
			</StackLayout>


			<Button Command="{Binding FetchResourceTokenCommand}"
			        IsEnabled="{Binding IsBusy, Converter={StaticResource bib}}"
			        Text="Fetch Resource Token" />

			<Label FontAttributes="Bold"
			       FontSize="Medium"
			       Text="Token:" />
			<Label HorizontalOptions="Center"
			       LineBreakMode="TailTruncation"
			       Text="{Binding Token}" />

			<StackLayout IsVisible="{Binding Token, Converter={StaticResource nvc}, ConverterParameter=switch}">
				<StackLayout Orientation="Horizontal">
					<Switch IsToggled="{Binding UseLocalCosmosDB}" />
					<Label Text="Use Local Cosmos DB Emulator" />
				</StackLayout>
				<Label FontAttributes="Bold"
				       FontSize="Medium"
				       Text="Name for DB Item" />
				<Entry Text="{Binding ModelName}" />
				<Button Command="{Binding CreateDBRecordCommand}"
				        IsEnabled="{Binding IsBusy, Converter={StaticResource bib}}"
				        Text="Create A CosmosDB Record!" />
			</StackLayout>

		</StackLayout>

		<Label Grid.Row="1"
		       FontAttributes="Bold"
		       FontSize="Medium"
		       Text="{Binding Message}"
		       TextColor="Red"
		       VerticalOptions="End" />
	</Grid>

</ContentPage>
